## ğŸ“š API å¯¹æ¥æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯

**è®¤è¯æ–¹å¼**ï¼šç­¾åè®¤è¯ï¼ˆè¯¦è§[ç­¾åç®—æ³•](#ç­¾åç®—æ³•)ï¼‰

**è¯·æ±‚æ ¼å¼**ï¼šJSON

**å“åº”æ ¼å¼**ï¼šJSON

---

## æ¥å£åˆ—è¡¨

### 1. åˆ›å»ºè®¢å•

åˆ›å»ºæ”¯ä»˜è®¢å•å¹¶è·å–æ”¶é“¶å°åœ°å€ã€‚

> **æ³¨æ„**ï¼šä½¿ç”¨ç›¸åŒ `order_id` åˆ›å»ºè®¢å•æ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®æœ€æ–°å‚æ•°é‡å»ºè®¢å•ï¼ˆè®¢å•é‡‘é¢ã€äº¤æ˜“ç±»å‹ã€æ”¶æ¬¾åœ°å€ã€æ³•å¸ç±»å‹ï¼‰ï¼ŒåŒæ—¶è¶…æ—¶æ—¶é—´é‡ç½®ã€‚è¿™æ„å‘³ç€å•†æˆ·å¯ä»¥åŸºäºåŒä¸€è®¢å•å·å®ç°ç‹¬ç«‹æ”¶é“¶å°ï¼Œçµæ´»å˜æ›´æ”¯ä»˜å‚æ•°ã€‚

#### è¯·æ±‚åœ°å€

```http
POST /api/v1/order/create-transaction
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å          | ç±»å‹     | å¿…å¡« | è¯´æ˜                                                                                                                                                          |
|--------------|--------|----|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| order_id     | string | âœ…  | å•†æˆ·è®¢å•ç¼–å·ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰                                                                                                                                                |
| amount       | number | âœ…  | æ”¯ä»˜é‡‘é¢ï¼ˆæ³•å¸é‡‘é¢ï¼‰                                                                                                                                                  |
| notify_url   | string | âœ…  | æ”¯ä»˜ç»“æœå¼‚æ­¥å›è°ƒåœ°å€                                                                                                                                                  |
| redirect_url | string | âœ…  | æ”¯ä»˜æˆåŠŸåå•†æˆ·è·³è½¬åœ°å€                                                                                                                                                 |
| signature    | string | âœ…  | ç­¾åå­—ç¬¦ä¸²ï¼ˆè¯¦è§[ç­¾åç®—æ³•](#ç­¾åç®—æ³•)ï¼‰                                                                                                                                      |
| trade_type   | string | âŒ  | äº¤æ˜“ç±»å‹ï¼Œé»˜è®¤ `usdt.trc20`<br/>å®Œæ•´åˆ—è¡¨ï¼š[trade-type.md](../trade-type.md)                                                                                             |
| fiat         | string | âŒ  | æ³•å¸ç±»å‹ï¼Œé»˜è®¤ `CNY`<br/>å¯é€‰ï¼š`CNY`ã€`USD`ã€`EUR`ã€`GBP`ã€`JPY`                                                                                                          |
| address      | string | âŒ  | æŒ‡å®šæ”¶æ¬¾åœ°å€ï¼ˆç•™ç©ºåˆ™è‡ªåŠ¨åˆ†é…ï¼‰                                                                                                                                             |
| name         | string | âŒ  | å•†å“åç§°                                                                                                                                                        |
| timeout      | number | âŒ  | è®¢å•è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œæœ€ä½ 60 ç§’<br/>ç•™ç©ºåˆ™ä½¿ç”¨é…ç½®æ–‡ä»¶ `expire_time`ï¼Œé»˜è®¤ 600 ç§’                                                                                                      |
| rate         | string | âŒ  | å¼ºåˆ¶æŒ‡å®šæ±‡ç‡ï¼Œæ”¯æŒå¤šç§å†™æ³•ï¼š<br/>â€¢ `7.4` - å›ºå®šæ±‡ç‡ 7.4<br/>â€¢ `~1.02` - æœ€æ–°æ±‡ç‡ä¸Šæµ® 2%<br/>â€¢ `~0.97` - æœ€æ–°æ±‡ç‡ä¸‹æµ® 3%<br/>â€¢ `+0.3` - æœ€æ–°æ±‡ç‡åŠ  0.3<br/>â€¢ `-0.2` - æœ€æ–°æ±‡ç‡å‡ 0.2<br/>ç•™ç©ºåˆ™ä½¿ç”¨ç³»ç»Ÿé…ç½®æ±‡ç‡ |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "order_id": "20250120001",
  "amount": 28.88,
  "fiat": "CNY",
  "trade_type": "usdt.trc20",
  "name": "æµ‹è¯•å•†å“",
  "address": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
  "notify_url": "https://example.com/notify",
  "redirect_url": "https://example.com/success",
  "timeout": 1200,
  "signature": "1cd4b52df5587cfb1968b0c0c6e156cd"
}
```

#### å“åº”å‚æ•°

| å‚æ•°å                  | ç±»å‹     | è¯´æ˜           |
|----------------------|--------|--------------|
| status_code          | number | çŠ¶æ€ç ï¼Œ200 è¡¨ç¤ºæˆåŠŸ |
| message              | string | å“åº”æ¶ˆæ¯         |
| data                 | object | è®¢å•æ•°æ®         |
| data.fiat            | string | äº¤æ˜“æ³•å¸ç±»å‹       |
| data.trade_id        | string | ç³»ç»Ÿäº¤æ˜“ ID      |
| data.order_id        | string | å•†æˆ·è®¢å•ç¼–å·       |
| data.amount          | string | è¯·æ±‚æ”¯ä»˜é‡‘é¢ï¼ˆæ³•å¸ï¼‰   |
| data.actual_amount   | string | å®é™…æ”¯ä»˜é‡‘é¢ï¼ˆåŠ å¯†è´§å¸ï¼‰ |
| data.token           | string | æ”¶æ¬¾åœ°å€         |
| data.expiration_time | number | è®¢å•æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰     |
| data.payment_url     | string | æ”¶é“¶å°åœ°å€        |

> **è®¡ç®—å…¬å¼**ï¼š`actual_amount` = `amount` Ã· æ±‡ç‡

#### å“åº”ç¤ºä¾‹

```json
{
  "status_code": 200,
  "message": "success",
  "data": {
    "fiat": "CNY",
    "trade_id": "b3d2477c-d945-41da-96b7-f925bbd1b415",
    "order_id": "20250120001",
    "amount": "28.88",
    "actual_amount": "4.25",
    "token": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
    "expiration_time": 1200,
    "payment_url": "https://example.com/pay/checkout-counter/b3d2477c-d945-41da-96b7-f925bbd1b415"
  },
  "request_id": ""
}
```

---

### 2. å–æ¶ˆè®¢å•

å–æ¶ˆæŒ‡å®šè®¢å•ï¼Œç³»ç»Ÿå°†åœæ­¢ç›‘æ§è¯¥è®¢å•å¹¶é‡Šæ”¾é‡‘é¢å ç”¨ã€‚

#### è¯·æ±‚åœ°å€

```http
POST /api/v1/order/cancel-transaction
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å       | ç±»å‹     | å¿…å¡« | è¯´æ˜      |
|-----------|--------|----|---------|
| trade_id  | string | âœ…  | ç³»ç»Ÿäº¤æ˜“ ID |
| signature | string | âœ…  | ç­¾åå­—ç¬¦ä¸²   |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "trade_id": "b3d2477c-d945-41da-96b7-f925bbd1b415",
  "signature": "1cd4b52df5587cfb1968b0c0c6e156cd"
}
```

#### å“åº”ç¤ºä¾‹

```json
{
  "status_code": 200,
  "message": "success",
  "data": {
    "trade_id": "b3d2477c-d945-41da-96b7-f925bbd1b415"
  },
  "request_id": ""
}
```

---

### 3. æ”¯ä»˜å›è°ƒé€šçŸ¥

è®¢å•çŠ¶æ€å˜æ›´æ—¶ï¼Œç³»ç»Ÿä¼šå‘ `notify_url` å‘é€ POST è¯·æ±‚ã€‚

#### é€šçŸ¥å‚æ•°

| å‚æ•°å                  | ç±»å‹     | è¯´æ˜                                                       |
|----------------------|--------|----------------------------------------------------------|
| trade_id             | string | ç³»ç»Ÿäº¤æ˜“ ID                                                  |
| order_id             | string | å•†æˆ·è®¢å•ç¼–å·                                                   |
| amount               | number | è¯·æ±‚æ”¯ä»˜é‡‘é¢ï¼ˆæ³•å¸ï¼‰                                               |
| actual_amount        | number | å®é™…æ”¯ä»˜é‡‘é¢ï¼ˆåŠ å¯†è´§å¸ï¼‰                                             |
| token                | string | æ”¶æ¬¾åœ°å€                                                     |
| block_transaction_id | string | åŒºå—é“¾äº¤æ˜“å“ˆå¸Œ                                                  |
| signature            | string | ç­¾åå­—ç¬¦ä¸²                                                    |
| status               | number | è®¢å•çŠ¶æ€ï¼š<br/>â€¢ `1` - ç­‰å¾…æ”¯ä»˜<br/>â€¢ `2` - æ”¯ä»˜æˆåŠŸ<br/>â€¢ `3` - æ”¯ä»˜è¶…æ—¶ |

#### é€šçŸ¥ç¤ºä¾‹

```json
{
  "trade_id": "b3d2477c-d945-41da-96b7-f925bbd1b415",
  "order_id": "20250120001",
  "amount": 28.88,
  "actual_amount": 4.25,
  "token": "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t",
  "block_transaction_id": "12ef6267b42e43959795cf31808d0cc72b3d0a48953ed19c61d4b6665a341d10",
  "signature": "1cd4b52df5587cfb1968b0c0c6e156cd",
  "status": 2
}
```

#### å“åº”è¦æ±‚

- **æˆåŠŸå“åº”**ï¼šè¿”å›å­—ç¬¦ä¸² `success`ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰
- **å¤±è´¥å“åº”**ï¼šè¿”å›å…¶ä»–å†…å®¹ï¼Œç³»ç»Ÿå°†é‡è¯•é€šçŸ¥

---

## ç­¾åç®—æ³•

### ç­¾åæµç¨‹

**ç¬¬ä¸€æ­¥ï¼šå‚æ•°æ’åºä¸æ‹¼æ¥**

1. ç­›é€‰æ‰€æœ‰ **éç©º** ä¸” **é signature** çš„å‚æ•°
2. æŒ‰å‚æ•°å **ASCII ç ** ä»å°åˆ°å¤§æ’åºï¼ˆå­—å…¸åºï¼‰
3. æŒ‰ `key=value` æ ¼å¼æ‹¼æ¥ï¼Œä½¿ç”¨ `&` è¿æ¥

**ç¬¬äºŒæ­¥ï¼šåŠ å¯†ç”Ÿæˆç­¾å**

1. åœ¨æ‹¼æ¥å­—ç¬¦ä¸²æœ«å°¾è¿½åŠ  API Tokenï¼ˆæ—  `&` ç¬¦å·ï¼‰
2. å¯¹å®Œæ•´å­—ç¬¦ä¸²è¿›è¡Œ MD5 åŠ å¯†
3. å°†ç»“æœè½¬ä¸º **å°å†™** å³ä¸º `signature`

### ç­¾åç¤ºä¾‹

å‡è®¾è¯·æ±‚å‚æ•°å¦‚ä¸‹ï¼š

```json
{
  "order_id": "20220201030210321",
  "amount": 42,
  "notify_url": "http://example.com/notify",
  "redirect_url": "http://example.com/redirect"
}
```

å‡è®¾ API Token ä¸ºï¼š`epusdt_password_xasddawqe`

**æ­¥éª¤ 1ï¼šæ’åºæ‹¼æ¥**

```text
amount=42&notify_url=http://example.com/notify&order_id=20220201030210321&redirect_url=http://example.com/redirect
```

**æ­¥éª¤ 2ï¼šè¿½åŠ  Token å¹¶åŠ å¯†**

```text
MD5(amount=42&notify_url=http://example.com/notify&order_id=20220201030210321&redirect_url=http://example.com/redirectepusdt_password_xasddawqe)
```

**æœ€ç»ˆç­¾å**ï¼š`1cd4b52df5587cfb1968b0c0c6e156cd`

### ä»£ç å‚è€ƒ

- **PHP å®ç°**ï¼š[ç‚¹å‡»æŸ¥çœ‹](https://github.com/v03413/Epay-BEpusdt/blob/b7fa8fd608d71ce50e0f8eabb1717783c96761ac/bepusdt_plugin.php#L108:L127)
- **Python å®ç°**ï¼š[BEpusdt Python SDK](https://github.com/luoyanglang/bepusdt-python-sdk)

### ç­¾åè§„åˆ™æ€»ç»“

| è§„åˆ™              | è¯´æ˜                            |
|-----------------|-------------------------------|
| å‚æ•°ååŒºåˆ†å¤§å°å†™        | `Amount` å’Œ `amount` æ˜¯ä¸åŒå‚æ•°     |
| ç©ºå€¼ä¸å‚ä¸ç­¾å         | `null`ã€`""`ã€`undefined` ç­‰å‡ä¸å‚ä¸ |
| signature ä¸å‚ä¸ç­¾å | ç­¾åæœ¬èº«ä¸å‚ä¸ç­¾åè®¡ç®—                   |
| å¿…é¡»æŒ‰å­—å…¸åºæ’åº        | ç¡®ä¿åŒæ–¹è®¡ç®—ç»“æœä¸€è‡´                    |
| MD5 ç»“æœå¿…é¡»å°å†™      | ç»Ÿä¸€ä½¿ç”¨å°å†™å­—æ¯                      |

---

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•è·å– API Tokenï¼Ÿ

ç™»å½•åå° -> ç³»ç»Ÿç®¡ç† -> åŸºæœ¬è®¾ç½® -> API è®¾ç½® -> å¯¹æ¥ä»¤ç‰Œ

### 2. è®¢å•é‡å»ºæœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ

å½“ä½¿ç”¨ç›¸åŒ `order_id` åˆ›å»ºè®¢å•æ—¶ï¼š

- âœ… æ›´æ–°è®¢å•é‡‘é¢ã€äº¤æ˜“ç±»å‹ã€æ”¶æ¬¾åœ°å€ã€æ³•å¸ç±»å‹
- âœ… **ä¼š** é‡ç½®è¶…æ—¶æ—¶é—´

### 3. æ”¯æŒå“ªäº›äº¤æ˜“ç±»å‹ï¼Ÿ

å®Œæ•´åˆ—è¡¨è¯·æŸ¥çœ‹ï¼š[`trade-type.md`](../trade-type.md)

å¸¸ç”¨ç±»å‹ï¼š

- `usdt.trc20` - USDT (TRC20)
- `usdt.erc20` - USDT (ERC20)
- `tron.trx` - TRX
- `usdc.polygon` - USDC (Polygon)

### 4. å›è°ƒé€šçŸ¥å¦‚ä½•éªŒè¯ç­¾åï¼Ÿ

ä½¿ç”¨ä¸è¯·æ±‚ç›¸åŒçš„ç­¾åç®—æ³•éªŒè¯ `signature` å‚æ•°ï¼Œç¡®ä¿é€šçŸ¥æ¥è‡ªå¯ä¿¡æºã€‚

### 5. å¦‚ä½•æµ‹è¯•å¯¹æ¥ï¼Ÿ

å»ºè®®æ­¥éª¤ï¼š

1. æ­å»ºæµ‹è¯•ç¯å¢ƒ
2. ä½¿ç”¨å°é¢æµ‹è¯•è®¢å•
3. éªŒè¯ç­¾åç®—æ³•æ­£ç¡®æ€§
4. æµ‹è¯•å›è°ƒé€šçŸ¥å¤„ç†é€»è¾‘
5. ç¡®è®¤è¶…æ—¶å’Œå–æ¶ˆåœºæ™¯

---

## å‚è€ƒèµ„æ–™

- [äº¤æ˜“ç±»å‹å®Œæ•´åˆ—è¡¨](../trade-type.md)
- [è®¢å•å›è°ƒé€šçŸ¥](../notify-epusdt.md)
- [æ˜“æ”¯ä»˜å¯¹æ¥æ’ä»¶](https://github.com/v03413/Epay-BEpusdt)
- [Python SDK](https://github.com/luoyanglang/bepusdt-python-sdk)
- [åŸé¡¹ç›®å‚è€ƒ](https://github.com/assimon/epusdt/blob/master/wiki/API.md)
